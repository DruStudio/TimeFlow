<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Flow Widgets</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            color: #e0e0e0; min-height: 100vh; transition: background 0.6s;
        }
        body.theme-ocean { background: linear-gradient(135deg, #0a0e27 0%, #1a1a2e 100%); --c1: #00d4ff; --c2: #00ffc8; }
        body.theme-sunset { background: linear-gradient(135deg, #1f0a27 0%, #2e1a3a 100%); --c1: #ff6b9d; --c2: #ffa06b; }
        body.theme-forest { background: linear-gradient(135deg, #0a1f14 0%, #1a2e24 100%); --c1: #00ff9f; --c2: #00ffea; }
        body.theme-purple { background: linear-gradient(135deg, #1a0a2e 0%, #2a1a3e 100%); --c1: #a78bfa; --c2: #c084fc; }
        body.theme-fire { background: linear-gradient(135deg, #2e1a0a 0%, #3e2a1a 100%); --c1: #fb923c; --c2: #fbbf24; }

```
    .controls {
        position: sticky; top: 0; z-index: 100; background: rgba(0,0,0,0.4);
        backdrop-filter: blur(30px); border-bottom: 1px solid rgba(255,255,255,0.1);
        padding: 18px; display: flex; justify-content: center; gap: 12px;
    }
    .theme-btn { width: 36px; height: 36px; border-radius: 50%; border: 2px solid transparent; cursor: pointer; transition: all 0.3s; }
    .theme-btn:hover { transform: scale(1.15); }
    .theme-btn.active { border-color: #fff; box-shadow: 0 0 12px rgba(255,255,255,0.4); }
    .theme-btn.ocean { background: linear-gradient(135deg, #00d4ff, #00ffc8); }
    .theme-btn.sunset { background: linear-gradient(135deg, #ff6b9d, #ffa06b); }
    .theme-btn.forest { background: linear-gradient(135deg, #00ff9f, #00ffea); }
    .theme-btn.purple { background: linear-gradient(135deg, #a78bfa, #c084fc); }
    .theme-btn.fire { background: linear-gradient(135deg, #fb923c, #fbbf24); }
    
    .header { text-align: center; padding: 80px 20px 60px; }
    .header h1 {
        font-size: 72px; font-weight: 800; letter-spacing: -2px;
        background: linear-gradient(135deg, var(--c1), var(--c2));
        -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 20px;
    }
    .header p { font-size: 20px; opacity: 0.8; }
    
    .swipe-hint { text-align: center; padding: 20px; opacity: 0.4; font-size: 13px; letter-spacing: 1px; }
    
    .carousel {
        display: flex; overflow-x: auto; scroll-snap-type: x mandatory;
        gap: 24px; padding: 0 20px 80px; scrollbar-width: none;
    }
    .carousel::-webkit-scrollbar { display: none; }
    
    .card {
        min-width: 85vw; max-width: 450px; scroll-snap-align: center; padding: 50px 40px 40px;
        background: rgba(40, 45, 55, 0.6); border-radius: 32px; border: 1px solid rgba(255,255,255,0.1);
        backdrop-filter: blur(30px); box-shadow: 0 25px 70px rgba(0,0,0,0.4);
    }
    
    .title {
        font-size: 56px; font-weight: 700; margin-bottom: 40px; text-align: center;
        background: linear-gradient(135deg, var(--c1), var(--c2));
        -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    
    .visual { width: 100%; height: 140px; margin-bottom: 30px; display: flex; align-items: center; justify-content: center; }
    
    .percent-section { text-align: center; margin-bottom: 10px; }
    
    .percent {
        font-size: 56px; font-weight: 700;
        background: linear-gradient(135deg, var(--c1), var(--c2));
        -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    
    .completed-label { font-size: 16px; opacity: 0.6; margin-left: 8px; }
    
    .time-info {
        display: flex; justify-content: space-around; margin-top: 24px;
        padding-top: 24px; border-top: 1px solid rgba(255,255,255,0.1);
    }
    .time-label { font-size: 11px; text-transform: uppercase; opacity: 0.5; margin-bottom: 8px; text-align: center; }
    .time-value { font-size: 16px; font-weight: 600; text-align: center; }
    
    .actions { display: flex; gap: 10px; margin-top: 24px; padding-top: 24px; border-top: 1px solid rgba(255,255,255,0.08); }
    .btn {
        flex: 1; padding: 12px; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15);
        border-radius: 12px; color: #e0e0e0; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;
    }
    .btn:hover { background: rgba(255,255,255,0.12); transform: translateY(-2px); }
    
    .generator { max-width: 520px; margin: 0 auto; padding: 0 20px 100px; }
    .generator h2 { font-size: 42px; font-weight: 700; text-align: center; margin-bottom: 50px; }
    
    .input-group { margin-bottom: 24px; }
    .input-group label {
        display: block; font-size: 12px; text-transform: uppercase;
        letter-spacing: 1.2px; opacity: 0.7; margin-bottom: 10px; font-weight: 600;
    }
    
    input, select {
        width: 100%; padding: 15px 18px; background: rgba(255,255,255,0.06);
        border: 1px solid rgba(255,255,255,0.12); border-radius: 14px;
        color: #e0e0e0; font-size: 15px;
    }
    input::placeholder { color: rgba(255,255,255,0.3); }
    input:focus, select:focus { outline: none; border-color: var(--c1); background: rgba(255,255,255,0.08); }
    
    .generate-btn {
        width: 100%; padding: 18px; background: linear-gradient(135deg, var(--c1), var(--c2));
        border: none; border-radius: 14px; color: #0a0e27; font-size: 17px;
        font-weight: 700; cursor: pointer; margin-top: 40px;
    }
    .generate-btn:hover { transform: translateY(-3px); }
    
    .output { display: none; padding: 0 0 80px; }
    .output.active { display: block; }
    
    #exportCanvas { display: none; }
    
    @media (max-width: 768px) {
        .header h1 { font-size: 48px; }
        .card { min-width: 90vw; }
        .title { font-size: 42px; }
        .percent-overlay { font-size: 42px; }
    }
</style>
```

</head>
<body class="theme-ocean">
    <div class="controls">
        <button class="theme-btn ocean active" onclick="setTheme('ocean')"></button>
        <button class="theme-btn sunset" onclick="setTheme('sunset')"></button>
        <button class="theme-btn forest" onclick="setTheme('forest')"></button>
        <button class="theme-btn purple" onclick="setTheme('purple')"></button>
        <button class="theme-btn fire" onclick="setTheme('fire')"></button>
    </div>

```
<div class="header">
    <h1>Time Flow</h1>
    <p>Create and share your own Time Flow widget</p>
</div>

<div class="swipe-hint" id="swipeHint">Swipe to explore â†’</div>
<div class="carousel" id="widgets"></div>

<div class="generator">
    <h2>Create Your Widget</h2>
    <div class="input-group">
        <label for="name">Widget Name</label>
        <input type="text" id="name" placeholder="e.g., My College Years">
    </div>
    <div class="input-group">
        <label for="start">Start Date</label>
        <input type="date" id="start">
    </div>
    <div class="input-group">
        <label for="end">End Date</label>
        <input type="date" id="end">
    </div>
    <div class="input-group">
        <label for="current">Current Date</label>
        <input type="date" id="current">
        <div style="display: flex; align-items: center; gap: 10px; margin-top: 10px;">
            <input type="checkbox" id="useToday" checked onchange="toggleCurrentDate()" style="width: auto;">
            <label for="useToday" style="margin: 0; text-transform: none; opacity: 0.8; font-size: 14px; cursor: pointer;">Use today's date</label>
        </div>
    </div>
    <div class="input-group">
        <label for="style">Visual Style</label>
        <select id="style">
            <option value="smooth">Smooth</option>
            <option value="glow">Glow</option>
            <option value="blocks">Blocks</option>
            <option value="arc">Arc</option>
            <option value="grid">Grid Fill</option>
        </select>
    </div>
    <div class="input-group">
        <label for="unit">Display Units</label>
        <select id="unit">
            <option value="auto">Auto</option>
            <option value="seconds">Seconds</option>
            <option value="minutes">Minutes/Hours</option>
            <option value="days">Days</option>
            <option value="months">Months</option>
            <option value="years">Years</option>
        </select>
    </div>
    <button class="generate-btn" onclick="generate()">Generate Widget</button>
</div>

<div class="output" id="output">
    <div style="text-align: center; padding: 40px 20px 20px; opacity: 0.5; font-size: 14px;">Your Widget</div>
    <div class="carousel" style="justify-content: center;">
        <div class="card" id="outputCard"></div>
    </div>
</div>

<canvas id="exportCanvas"></canvas>

<script>
    function getWinterDates() {
        const now = new Date();
        const year = now.getFullYear();
        const month = now.getMonth();
        
        if (month < 2 || (month === 2 && now.getDate() <= 20)) {
            return { start: new Date(year-1, 11, 21), end: new Date(year, 2, 20) };
        } else if (month >= 11 && now.getDate() >= 21) {
            return { start: new Date(year, 11, 21), end: new Date(year+1, 2, 20) };
        } else {
            return { start: new Date(year, 11, 21), end: new Date(year+1, 2, 20) };
        }
    }

    const winter = getWinterDates();
    
    // Calculate My Home Project to be exactly 76% complete
    const projectDays = 365;
    const elapsedDays = Math.floor(projectDays * 0.76);
    const now = new Date();
    const projectStart = new Date(now);
    projectStart.setDate(projectStart.getDate() - elapsedDays);
    const projectEnd = new Date(projectStart);
    projectEnd.setDate(projectEnd.getDate() + projectDays);

    const widgets = [
        { name: '2026', start: new Date(2026,0,1), end: new Date(2026,11,31,23,59,59), unit: 'auto' },
        { name: 'Today', start: new Date(new Date().setHours(0,0,0,0)), end: new Date(new Date().setHours(23,59,59,999)), unit: 'minutes' },
        { name: 'Trump Presidency', start: new Date(2025,0,20), end: new Date(2029,0,20), unit: 'days' },
        { name: 'Winter', start: winter.start, end: winter.end, unit: 'auto' },
        { name: 'My Home Project', start: projectStart, end: projectEnd, unit: 'days' }
    ];
    const styles = ['grid', 'arc', 'blocks', 'smooth', 'glow'];
    let theme = 'ocean';
    let generatedWidget = null;

    function setTheme(t) {
        theme = t;
        document.body.className = 'theme-' + t;
        document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
        document.querySelector('.theme-btn.' + t).classList.add('active');
        widgets.forEach((w, i) => {
            const now = new Date();
            const prog = Math.max(0, Math.min(1, (now - w.start) / (w.end - w.start)));
            draw(document.getElementById('c'+i), prog, styles[i]);
        });
        if (generatedWidget) {
            draw(document.getElementById('out'), generatedWidget.prog, generatedWidget.style);
        }
    }

    function getColors() {
        if (theme === 'ocean') return ['#00d4ff', '#00ffc8'];
        if (theme === 'sunset') return ['#ff6b9d', '#ffa06b'];
        if (theme === 'forest') return ['#00ff9f', '#00ffea'];
        if (theme === 'purple') return ['#a78bfa', '#c084fc'];
        return ['#fb923c', '#fbbf24'];
    }

    function fmt(ms, unit) {
        const s = ms/1000, m = s/60, h = m/60, d = h/24, mo = d/30, y = d/365;
        if (unit === 'seconds') return Math.floor(s) + 's';
        if (unit === 'minutes') return Math.floor(h) + 'h ' + Math.floor(m%60) + 'm';
        if (unit === 'days') return Math.floor(d) + ' days';
        if (unit === 'months') return Math.floor(mo) + ' months';
        if (unit === 'years') return y.toFixed(1) + ' years';
        if (d > 365) return y.toFixed(1) + ' years';
        if (d > 30) return Math.floor(mo) + ' months';
        if (d > 0) return Math.floor(d) + ' days';
        return Math.floor(h) + 'h ' + Math.floor(m%60) + 'm';
    }

    function draw(canvas, prog, style) {
        const ctx = canvas.getContext('2d');
        const w = canvas.width, h = canvas.height;
        const colors = getColors();
        ctx.clearRect(0, 0, w, h);
        const bw = w - 60, x = 30;

        if (style === 'smooth') {
            const bh = 14, y = h/2 - bh/2;
            ctx.fillStyle = 'rgba(255,255,255,0.08)';
            ctx.beginPath(); ctx.roundRect(x, y, bw, bh, 7); ctx.fill();
            const g = ctx.createLinearGradient(x, 0, x+bw, 0);
            g.addColorStop(0, colors[0]); g.addColorStop(1, colors[1]);
            ctx.fillStyle = g;
            ctx.beginPath(); ctx.roundRect(x, y, bw*prog, bh, 7); ctx.fill();
        } else if (style === 'glow') {
            const bh = 50, y = h/2 - bh/2;
            ctx.fillStyle = 'rgba(255,255,255,0.06)';
            ctx.beginPath(); ctx.roundRect(x, y, bw, bh, 25); ctx.fill();
            const g = ctx.createLinearGradient(x, 0, x+bw, 0);
            g.addColorStop(0, colors[0]); g.addColorStop(0.5, colors[1]); g.addColorStop(1, colors[0]);
            ctx.fillStyle = g; ctx.shadowBlur = 25; ctx.shadowColor = colors[0];
            ctx.beginPath(); ctx.roundRect(x, y, bw*prog, bh, 25); ctx.fill();
            ctx.shadowBlur = 0;
        } else if (style === 'blocks') {
            const cnt = 25, gap = 3, bh = 50, y = h/2 - bh/2;
            const bkw = (bw - gap * (cnt - 1)) / cnt;
            for (let i = 0; i < cnt; i++) {
                const bx = x + (i * (bkw + gap));
                const active = (i/cnt) < prog;
                if (active) {
                    const t = i/cnt;
                    ctx.fillStyle = `rgb(${Math.round(parseInt(colors[0].slice(1,3),16)*(1-t)+parseInt(colors[1].slice(1,3),16)*t)},${Math.round(parseInt(colors[0].slice(3,5),16)*(1-t)+parseInt(colors[1].slice(3,5),16)*t)},${Math.round(parseInt(colors[0].slice(5,7),16)*(1-t)+parseInt(colors[1].slice(5,7),16)*t)})`;
                } else {
                    ctx.fillStyle = 'rgba(255,255,255,0.06)';
                }
                ctx.beginPath(); ctx.roundRect(bx, y, bkw, bh, 6); ctx.fill();
            }
        } else if (style === 'arc') {
            const cx = w/2, cy = h/2 + 25, r = 70, lw = 28;
            
            // Background arc
            ctx.beginPath();
            ctx.arc(cx, cy, r, Math.PI * 0.7, Math.PI * 2.3);
            ctx.strokeStyle = 'rgba(255,255,255,0.08)';
            ctx.lineWidth = lw;
            ctx.lineCap = 'round';
            ctx.stroke();
            
            // Progress arc with gradient
            if (prog > 0) {
                const endAngle = Math.PI * 0.7 + (Math.PI * 1.6 * prog);
                const g = ctx.createLinearGradient(
                    cx + r * Math.cos(Math.PI * 0.7), 
                    cy + r * Math.sin(Math.PI * 0.7),
                    cx + r * Math.cos(endAngle), 
                    cy + r * Math.sin(endAngle)
                );
                g.addColorStop(0, colors[0]);
                g.addColorStop(1, colors[1]);
                
                ctx.beginPath();
                ctx.arc(cx, cy, r, Math.PI * 0.7, endAngle);
                ctx.strokeStyle = g;
                ctx.lineWidth = lw;
                ctx.lineCap = 'round';
                ctx.shadowBlur = 15;
                ctx.shadowColor = colors[0];
                ctx.stroke();
                ctx.shadowBlur = 0;
            }
        } else if (style === 'grid') {
            const rows = 5, cols = 10, cellW = 26, cellH = 20, gap = 4;
            const gridW = cols * cellW + (cols - 1) * gap;
            const startX = (w - gridW) / 2, startY = h/2 - (rows * cellH + (rows - 1) * gap) / 2;
            const total = rows * cols, active = Math.floor(total * prog);
            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    const idx = r * cols + c;
                    const cx = startX + c * (cellW + gap), cy = startY + r * (cellH + gap);
                    if (idx < active) {
                        const t = idx / total;
                        ctx.fillStyle = `rgb(${Math.round(parseInt(colors[0].slice(1,3),16)*(1-t)+parseInt(colors[1].slice(1,3),16)*t)},${Math.round(parseInt(colors[0].slice(3,5),16)*(1-t)+parseInt(colors[1].slice(3,5),16)*t)},${Math.round(parseInt(colors[0].slice(5,7),16)*(1-t)+parseInt(colors[1].slice(5,7),16)*t)})`;
                    } else {
                        ctx.fillStyle = 'rgba(255,255,255,0.1)';
                    }
                    ctx.beginPath(); ctx.roundRect(cx, cy, cellW, cellH, 4); ctx.fill();
                }
            }
        }
    }

    function makeCard(w, idx) {
        const now = new Date();
        const prog = Math.max(0, Math.min(1, (now - w.start) / (w.end - w.start)));
        const el = now - w.start, rm = w.end - now;
        return `<div class="card">
            <h2 class="title">${w.name}</h2>
            <div class="visual">
                <canvas id="c${idx}" width="370" height="140"></canvas>
            </div>
            <div class="percent-section">
                <span class="percent">${Math.round(prog*100)}%</span>
                <span class="completed-label">completed</span>
            </div>
            <div class="time-info">
                <div><div class="time-label">Elapsed</div><div class="time-value">${fmt(el, w.unit)}</div></div>
                <div><div class="time-label">Remaining</div><div class="time-value">${fmt(rm, w.unit)}</div></div>
            </div>
            <div class="actions">
                <button class="btn" onclick="alert('Copied!')">Copy Link</button>
                <button class="btn" onclick="alert('Saving...')">Save Image</button>
            </div>
        </div>`;
    }

    function init() {
        document.getElementById('widgets').innerHTML = widgets.map((w, i) => makeCard(w, i)).join('');
        widgets.forEach((w, i) => {
            const now = new Date();
            const prog = Math.max(0, Math.min(1, (now - w.start) / (w.end - w.start)));
            setTimeout(() => draw(document.getElementById('c'+i), prog, styles[i]), 300);
        });
    }

    function toggleCurrentDate() {
        const currentInput = document.getElementById('current');
        const useToday = document.getElementById('useToday').checked;
        currentInput.disabled = useToday;
        if (useToday) {
            currentInput.value = '';
        }
    }

    function generate() {
        const name = document.getElementById('name').value;
        const startInput = document.getElementById('start').value;
        const endInput = document.getElementById('end').value;
        const currentInput = document.getElementById('current').value;
        const useToday = document.getElementById('useToday').checked;
        const style = document.getElementById('style').value;
        const unit = document.getElementById('unit').value;
        
        // Check all fields are filled
        if (!name) {
            alert('Please enter a widget name');
            return;
        }
        if (!startInput) {
            alert('Please select a start date');
            return;
        }
        if (!endInput) {
            alert('Please select an end date');
            return;
        }
        if (!useToday && !currentInput) {
            alert('Please select a current date or check "Use today\'s date"');
            return;
        }
        if (!style) {
            alert('Please select a visual style');
            return;
        }
        if (!unit) {
            alert('Please select display units');
            return;
        }
        
        const start = new Date(startInput);
        const end = new Date(endInput);
        const current = useToday ? new Date() : new Date(currentInput);
        
        // Validate dates
        if (start >= end) {
            alert('End date must be after start date');
            return;
        }
        
        // Check if current date is between start and end
        if (current < start) {
            alert('Current date must be after start date');
            return;
        }
        if (current > end) {
            alert('Current date must be before end date');
            return;
        }
        
        const prog = Math.max(0, Math.min(1, (current - start) / (end - start)));
        generatedWidget = { name, prog, el: current - start, rm: end - current, style, unit };
        document.getElementById('outputCard').innerHTML = `<h2 class="title">${name}</h2>
            <div class="visual">
                <canvas id="out" width="370" height="140"></canvas>
            </div>
            <div class="percent-section">
                <span class="percent">${Math.round(prog*100)}%</span>
                <span class="completed-label">completed</span>
            </div>
            <div class="time-info">
                <div><div class="time-label">Elapsed</div><div class="time-value">${fmt(generatedWidget.el, unit)}</div></div>
                <div><div class="time-label">Remaining</div><div class="time-value">${fmt(generatedWidget.rm, unit)}</div></div>
            </div>
            <div class="actions">
                <button class="btn" onclick="alert('Copied!')">Copy Link</button>
                <button class="btn" onclick="alert('Saving...')">Save Image</button>
            </div>`;
        document.getElementById('output').classList.add('active');
        document.getElementById('output').scrollIntoView({ behavior: 'smooth', block: 'center' });
        setTimeout(() => draw(document.getElementById('out'), prog, style), 100);
    }

    window.onload = function() {
        init();
        document.getElementById('current').disabled = true;
    };
</script>
```

</body>
</html>
